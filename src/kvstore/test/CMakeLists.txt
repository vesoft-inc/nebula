set(KVSTORE_TEST_LIBS
    kvstore_obj
    raftex_obj
    wal_obj
    disk_man_obj
    keyutils_obj
    meta_keyutils_obj
    log_str_list_iterator_obj
    codec_obj
    meta_obj
    meta_client_obj
    ws_obj
    ws_common_obj
    http_client_obj
    meta_thrift_obj
    common_thrift_obj
    raftex_thrift_obj
    base_obj
    datatypes_obj
    conf_obj
    thread_obj
    fs_obj
    file_based_cluster_id_man_obj
    network_obj
    thrift_obj
    time_obj
    stats_obj
    expression_obj
    function_manager_obj
    wkt_wkb_io_obj
    agg_function_manager_obj
    time_utils_obj
    datetime_parser_obj
    process_obj
    ft_es_storage_adapter_obj
    version_obj
    ssl_obj
    storage_thrift_obj
    geo_index_obj
    stats_obj
    meta_client_stats_obj
    storage_client_stats_obj
    kv_stats_obj
)

nebula_add_test(
    NAME
        part_test
    SOURCES
        PartTest.cpp
    LIBRARIES
        ${KVSTORE_TEST_LIBS}
    LIBRARIES
        ${THRIFT_LIBRARIES}
        ${ROCKSDB_LIBRARIES}
        ${PROXYGEN_LIBRARIES}
        wangle
        gtest
)

nebula_add_test(
    NAME
        rocks_engine_test
    SOURCES
        RocksEngineTest.cpp
    LIBRARIES
        ${KVSTORE_TEST_LIBS}
    LIBRARIES
        ${THRIFT_LIBRARIES}
        ${ROCKSDB_LIBRARIES}
        ${PROXYGEN_LIBRARIES}
        wangle
        gtest
)

nebula_add_test(
    NAME
        nebula_store_test
    SOURCES
        NebulaStoreTest.cpp
    LIBRARIES
        ${KVSTORE_TEST_LIBS}
    LIBRARIES
        ${THRIFT_LIBRARIES}
        ${ROCKSDB_LIBRARIES}
        ${PROXYGEN_LIBRARIES}
        wangle
        gtest
)

nebula_add_test(
    NAME
        nebula_listener_test
    SOURCES
        NebulaListenerTest.cpp
    LIBRARIES
        ${KVSTORE_TEST_LIBS}
    LIBRARIES
        ${THRIFT_LIBRARIES}
        ${ROCKSDB_LIBRARIES}
        ${PROXYGEN_LIBRARIES}
        wangle
        gtest
)

nebula_add_test(
    NAME
        rocks_engine_config_test
    SOURCES
        RocksEngineConfigTest.cpp
    LIBRARIES
        ${KVSTORE_TEST_LIBS}
    LIBRARIES
        ${THRIFT_LIBRARIES}
        ${ROCKSDB_LIBRARIES}
        ${PROXYGEN_LIBRARIES}
        wangle
        gtest
)

nebula_add_test(
    NAME
        disk_man_test
    SOURCES
        DiskManagerTest.cpp
    LIBRARIES
        ${KVSTORE_TEST_LIBS}
    LIBRARIES
        ${THRIFT_LIBRARIES}
        ${ROCKSDB_LIBRARIES}
        ${PROXYGEN_LIBRARIES}
        wangle
        gtest
)

nebula_add_test(
    NAME
        log_encoder_test
    SOURCES
        LogEncoderTest.cpp
    LIBRARIES
        ${KVSTORE_TEST_LIBS}
    LIBRARIES
        ${THRIFT_LIBRARIES}
        ${ROCKSDB_LIBRARIES}
        ${PROXYGEN_LIBRARIES}
        wangle
        gtest
)

nebula_add_test(
    NAME
        snapshot_link_test
    SOURCES
        SnapshotLinkTest.cpp
    LIBRARIES
        ${KVSTORE_TEST_LIBS}
    LIBRARIES
        ${THRIFT_LIBRARIES}
        ${ROCKSDB_LIBRARIES}
        ${PROXYGEN_LIBRARIES}
        wangle
        gtest
)

nebula_add_executable(
    NAME
        multi_versions_perf_test_bm
    SOURCES
        MultiVersionBenchmark.cpp
    LIBRARIES
        ${KVSTORE_TEST_LIBS}
    LIBRARIES
        ${THRIFT_LIBRARIES}
        ${ROCKSDB_LIBRARIES}
        ${PROXYGEN_LIBRARIES}
        wangle
        follybenchmark
        boost_regex
)

nebula_add_executable(
    NAME
        part_performance_test
    SOURCES
        PartPerformanceTest.cpp
    LIBRARIES
        ${KVSTORE_TEST_LIBS}
    LIBRARIES
        ${THRIFT_LIBRARIES}
        ${ROCKSDB_LIBRARIES}
        ${PROXYGEN_LIBRARIES}
        wangle
        follybenchmark
        gtest
        boost_regex
)

nebula_add_test(
    NAME
        rate_limiter_test
    SOURCES
        RateLimiterTest.cpp
    LIBRARIES
        ${KVSTORE_TEST_LIBS}
    LIBRARIES
        ${THRIFT_LIBRARIES}
        ${ROCKSDB_LIBRARIES}
        ${PROXYGEN_LIBRARIES}
        wangle
        gtest
)
