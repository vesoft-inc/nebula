set(WAL_TEST_LIBS
    wal_obj
    disk_man_obj
    meta_thrift_obj
    common_thrift_obj
    datatypes_obj
    base_obj
    thread_obj
    fs_obj
    time_obj
    thread_obj
    wkt_wkb_io_obj
)

nebula_add_test(
    NAME
        file_based_wal_test
    SOURCES
        FileBasedWalTest.cpp
    LIBRARIES
        ${WAL_TEST_LIBS}
    LIBRARIES
        ${THRIFT_LIBRARIES}
        gtest
)

nebula_add_test(
    NAME
        inmemory_log_buffer_test
    SOURCES
        InMemoryLogBufferTest.cpp
        InMemoryLogBuffer.cpp
    LIBRARIES
        ${WAL_TEST_LIBS}
    LIBRARIES
        ${THRIFT_LIBRARIES}
        gtest
)

nebula_add_test(
    NAME
        atomic_log_buffer_test
    SOURCES
        AtomicLogBufferTest.cpp
    LIBRARIES
        ${WAL_TEST_LIBS}
    LIBRARIES
        ${THRIFT_LIBRARIES}
        gtest
)

nebula_add_executable(
    NAME
        log_bufferr_bm
    SOURCES
        LogBufferBenchmark.cpp
        InMemoryLogBuffer.cpp
    LIBRARIES
        ${WAL_TEST_LIBS}
    LIBRARIES
        ${THRIFT_LIBRARIES}
        follybenchmark
        boost_regex
)

nebula_add_test(
    NAME
        wal_file_iter_test
    SOURCES
        WalFileIterTest.cpp
    LIBRARIES
        ${WAL_TEST_LIBS}
    LIBRARIES
        ${THRIFT_LIBRARIES}
        gtest
)
